{
  "hash": "c1a88a0c6eca047ca179f8989bec6d2e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Make a highlighted time-series plot\"\ndescription: |\n  Time-series analyses can be handy for seeing trends over time, and exploring how trends relate to major events. Here, we show how to create an exploratory time-series plot comparing observations of waterbirds prior to and during the COVID-19 pandemic.\nauthor:\n  - name: \"Thai Rushbrook\"\n  - name: \"Olivia Torresan\"\n  - name: \"Dax Kellie\"\ndate: \"2023-04-03\"\ntitle-block-banner: \"#B8573E\"\ntoc: true\ntoc-location: left\ntoc-depth: 3\ncategories:\n  - Eukaryota\n  - Animalia\n  - Aves\n  - Summaries\n  - Intern-post\nimage: ducks.png\nfreeze: true\n---\n\n\n\n\n<!-- remove metadata section -->\n\n::: {.cell}\n<style type=\"text/css\">\n#title-block-header.quarto-title-block.default .quarto-title-meta {\n    display: none;\n}\n</style>\n:::\n\n\n\n<!-- Author card -->\n\n:::{.author-card}\n:::{.author-card-text}\n\n#### Author\nThai Rushbrook  \n[Olivia Torresan](https://labs.ala.org.au/about/Torresan_Olivia/index.html)  \n[Dax Kellie](https://labs.ala.org.au/about/Kellie_Dax/index.html)  \n\n#### Date\n3 April 2023\n\n:::\n\n:::{.author-card-image}\n\n::: {.cell}\n::: {.cell-output-display}\n![](https://raw.githubusercontent.com/AtlasOfLivingAustralia/ala-labs/main/images/people/thai.jpg){width=120px style=\"clip-path: circle();\"}\n:::\n:::\n\n:::\n\n:::{.author-card-image}\n\n::: {.cell}\n::: {.cell-output-display}\n![](https://raw.githubusercontent.com/AtlasOfLivingAustralia/ala-labs/main/images/people/olivia.jpg){width=120px style=\"clip-path: circle();\"}\n:::\n:::\n\n:::\n\n:::{.author-card-image}\n\n::: {.cell}\n::: {.cell-output-display}\n![](https://raw.githubusercontent.com/AtlasOfLivingAustralia/ala-labs/main/images/people/dax.jpg){width=120px style=\"clip-path: circle();\"}\n:::\n:::\n\n:::\n\n:::\n\n<!------------------------ Post starts here ------------------------>\n\n:::{.callout-tip}\n\n## Intern Post\n\n:::\n\nA majority of species observations in the Atlas of Living Australia are collected opportunistically, where people record observations incidentally rather than through an ongoing monitoring program.\n\nHowever, whether an observation is recorded or not doesn't just depend on the species. It might be rainy, it might be too hot, an area might be inaccessible; all of these factors can affect whether people make an observation.\n\nThe COVID-19 pandemic had a major impact on people's health, behaviour and travel. In Australia, several lockdowns over 2020-2021 imposed restrictions on people's movements, limiting them to certain activities near their homes. Melbourne experienced [the longest continuous lockdown in the world](https://www.9news.com.au/national/coronavirus-update-victoria-monday-october-4-melbournes-lockdown-longest-world/e159d5b5-2d0f-452a-adb3-979150f9793f). \n\nTo what extent did COVID-19 and lockdowns affect the number of species observations people made over that time? Here, we'll use a highlighted time-series plot to investigate how lockdowns in Melbourne affected the observations of *Anatidae* (ducks, geese and swans), a taxonomic group frequently seen on walks and outdoor gatherings, compared to previous years.\n\n# Get data\n\nWe'll start by downloading *Anatidae* records.\n\n:::{layout-ncol=3 style=\"width=120px;\"}\n\n<img class = \"clipped\" src=\"https://ala-images.s3.ap-southeast-2.amazonaws.com/store/5/9/2/0/cd4a660e-358c-4863-81b8-08cfd7280295/original\"></img>\n\n<img class = \"clipped\"src=\"https://ala-images.s3.ap-southeast-2.amazonaws.com/store/7/c/4/2/b133aa0c-ba9f-4f19-8f2f-938f34b724c7/original\"></img>\n\n<img class = \"clipped\" src=\"https://ala-images.s3.ap-southeast-2.amazonaws.com/store/1/c/9/e/f35fbe9d-1116-4eb2-82d4-03d8e032e9c1/original\"></img>\n\n:::\n::: {.figure-caption}\nLeft: [*Tadorna (Casarca) tadornoides* (Tracey Hinton CC-BY-NC 4.0 (Int))](https://biocache.ala.org.au/occurrences/31f020c4-1050-40e7-b499-8cf89afa84fe) Middle: [*Cygnus (Chenopis) atratus* (jpshahady CC-BY-NC 4.0 (Int))](https://biocache.ala.org.au/occurrences/2af3958b-1a06-45a7-8ee2-315c63c2f0c6) Right: [*Spatula rhynchotis* (Annette Green CC-BY-NC 4.0 (Int))](https://biocache.ala.org.au/occurrences/546765db-4567-479d-b78f-77433493fae6)\n:::\n\nFirst, let's load some packages: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load packages\nlibrary(galah)\nlibrary(tidyverse)\nlibrary(grid)\nlibrary(pilot) # remotes::install_github(\"olihawkins/pilot\")\nlibrary(ggtext)\nlibrary(showtext)\n```\n:::\n\n\nLet's use the [{galah} package](http://galah.ala.org.au/) to download *Anatidae* records in Melbourne from years before and during COVID-19. \n\nSearching with `search_all(fields)` shows us that {galah} contains [Greater Capital City Statistical Areas](https://www.abs.gov.au/statistics/standards/australian-statistical-geography-standard-asgs-edition-3/jul2021-jun2026/main-structure-and-greater-capital-city-statistical-areas/greater-capital-city-statistical-areas), which we can use to filter our query. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsearch_all(fields, \"city\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  id      description                                            type  \n  <chr>   <chr>                                                  <chr> \n1 cl10929 PSMA ABS Greater Capital City Statistical Areas (2016) fields\n```\n\n\n:::\n\n```{.r .cell-code}\nsearch_all(fields, \"city\") |> search_values(\"melbourne\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• Showing values for 'cl10929'.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  cl10929          \n  <chr>            \n1 GREATER MELBOURNE\n```\n\n\n:::\n:::\n\n\n\nLet's build our query to return *Anatidae* records from `GREATER MELBOURNE` and use `galah_select()` to return only the `eventDate` column.\n\nYou will need to first provide a [registered email with the ALA](https://auth.ala.org.au/userdetails/registration/createAccount) using `galah_config()` before retrieving records.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add registered email (register at ala.org.au)\ngalah_config(email = \"your-email@email.com\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds <-\n  galah_call() |>\n  galah_identify(\"Anatidae\") |>\n  galah_filter(\n    cl10929 == \"GREATER MELBOURNE\",\n    year >= 2017,\n    year <= 2021,\n    basisOfRecord == \"HUMAN_OBSERVATION\"\n  ) |>\n  galah_select(eventDate) |>\n  atlas_occurrences()\n\nbirds |> slice_sample(n = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 2\n   recordID                             eventDate          \n   <chr>                                <dttm>             \n 1 1f2ecd45-a862-46c8-a3ac-629fd43ea95c 2018-02-17 13:54:00\n 2 d2752ab2-ec46-40f1-82f8-422969dc6e5c 2021-07-09 11:02:00\n 3 c2d69c66-24f3-4f35-9701-f1f26b514fec 2019-07-21 08:40:00\n 4 1a8b43ea-109f-453d-9432-b614b9c67424 2021-09-02 16:26:00\n 5 577740ce-701a-4389-aa02-97b62a485ca6 2020-09-18 10:20:00\n 6 6d122db3-1478-419e-9f6b-e31a41ab2488 2021-12-29 13:45:00\n 7 7749f3fb-db99-4339-ba45-e5a6eea9d1bf 2021-08-09 07:52:00\n 8 b45fdcb9-10d8-4aee-a528-8de6df94297d 2019-10-05 09:16:00\n 9 88a30420-0a28-4c99-a628-d06bd4d73e49 2019-11-16 08:31:00\n10 e0e783fe-5183-4e07-b01a-1a7e373836ba 2018-06-09 12:24:00\n```\n\n\n:::\n:::\n\n\nWe'll then extract the week and year of each date and count the total observations for each week.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds_weekly <- birds |> \n  mutate(date = as_date(eventDate),\n         year = year(eventDate),\n         week = week(eventDate)) |>\n  filter(year > 2016) |> # remove stray 2016 records\n  group_by(year, week) |>\n  summarise(week_obs = n())\n\nbirds_weekly \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 265 × 3\n# Groups:   year [5]\n    year  week week_obs\n   <dbl> <dbl>    <int>\n 1  2017     1      831\n 2  2017     2      679\n 3  2017     3      725\n 4  2017     4      775\n 5  2017     5      767\n 6  2017     6      771\n 7  2017     7      651\n 8  2017     8      660\n 9  2017     9      703\n10  2017    10      689\n# ℹ 255 more rows\n```\n\n\n:::\n:::\n\n\nWe want to compare observations recorded in 2020-2021 to previous years, but because we know that contributions to the ALA have increased each year, comparing raw numbers will be an unequal comparison and bias our results.\n\nTo avoid this, let's *scale* our weekly record counts by the total number of *Anatidae* observations each year. Doing this let's us compare proportions rather than raw numbers. \n\nFirst let's download the total *Anatidae* records for each year. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds_yearly <- \n  galah_call() |>    \n  galah_identify(\"Anatidae\") |> \n  galah_filter(cl10929 == \"GREATER MELBOURNE\", \n               year >= 2017, year <= 2021) |> \n  galah_group_by(year) |>\n  atlas_counts() |>\n  rename(year_obs = count) |>\n  mutate(year = as.numeric(year)) |>\n  arrange(-desc(year))\n  \nbirds_yearly\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n   year year_obs\n  <dbl>    <int>\n1  2017    39359\n2  2018    50768\n3  2019    48939\n4  2020    49837\n5  2021    58878\n```\n\n\n:::\n:::\n\n\nNow we'll join `birds_yearly` with `birds_weekly` so we can calculate the proportion of records observed each week. We'll do this by dividing each row's weekly total by the yearly total.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds_prop <- birds_weekly |> \n  left_join(birds_yearly) |> \n  rowwise() |> \n  mutate(prop = week_obs / year_obs,\n         .keep = \"unused\") |> \n  ungroup()\n\nbirds_prop\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 265 × 3\n    year  week   prop\n   <dbl> <dbl>  <dbl>\n 1  2017     1 0.0211\n 2  2017     2 0.0173\n 3  2017     3 0.0184\n 4  2017     4 0.0197\n 5  2017     5 0.0195\n 6  2017     6 0.0196\n 7  2017     7 0.0165\n 8  2017     8 0.0168\n 9  2017     9 0.0179\n10  2017    10 0.0175\n# ℹ 255 more rows\n```\n\n\n:::\n:::\n\n\nTo compare observations in years prior to and during COVID-19, we'll want to plot two lines: \n\n  1. A baseline of average weekly observation counts in 2017-2019 \n  2. A line with weekly observation counts over 2020 and 2021\n\nTo create the average 2017-2019 baseline, let's calculate the mean proportion of records each week from 2017-2019.\n\nTo do this, we'll place our weekly proportions in separate columns using `pivot_wider()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds_wide <- birds_prop |>\n  pivot_wider(names_from = year, \n              values_from = prop, \n              names_sort = TRUE,\n              names_glue = \"year_{year}\")\n\nbirds_wide\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 53 × 6\n    week year_2017 year_2018 year_2019 year_2020 year_2021\n   <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>\n 1     1    0.0211    0.0209    0.0338    0.0313    0.0225\n 2     2    0.0173    0.0178    0.0350    0.0228    0.0191\n 3     3    0.0184    0.0168    0.0258    0.0239    0.0201\n 4     4    0.0197    0.0158    0.0236    0.0244    0.0190\n 5     5    0.0195    0.0164    0.0201    0.0155    0.0184\n 6     6    0.0196    0.0137    0.0200    0.0180    0.0194\n 7     7    0.0165    0.0176    0.0190    0.0154    0.0168\n 8     8    0.0168    0.0138    0.0184    0.0153    0.0192\n 9     9    0.0179    0.0151    0.0144    0.0131    0.0186\n10    10    0.0175    0.0132    0.0215    0.0115    0.0163\n# ℹ 43 more rows\n```\n\n\n:::\n:::\n\n\nThen we'll calculate the mean proportion of observations each week across `year_2017`, `year_2018` and `year_2019` columns.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds_mean_prop <- birds_wide |>\n  rowwise() |>\n  mutate(\n    mean_2017_19 = mean(c_across(year_2017:year_2019)),\n    .keep = \"unused\"\n    ) |>\n  ungroup()\n\nbirds_mean_prop\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 53 × 4\n    week year_2020 year_2021 mean_2017_19\n   <dbl>     <dbl>     <dbl>        <dbl>\n 1     1    0.0313    0.0225       0.0253\n 2     2    0.0228    0.0191       0.0234\n 3     3    0.0239    0.0201       0.0203\n 4     4    0.0244    0.0190       0.0197\n 5     5    0.0155    0.0184       0.0187\n 6     6    0.0180    0.0194       0.0178\n 7     7    0.0154    0.0168       0.0177\n 8     8    0.0153    0.0192       0.0163\n 9     9    0.0131    0.0186       0.0158\n10    10    0.0115    0.0163       0.0174\n# ℹ 43 more rows\n```\n\n\n:::\n:::\n\n\nNow we have all the numbers we need for plotting! We just need to reorganise them so that they plot correctly. \n\nTwo columns in `birds_mean_prop` contain proportional counts for 2020 and 2021. Although there are 52 weeks in a year, both years extend from weeks 1-53 because neither year started or ended *exactly* at the end of the week — 2020 ended on a Thursday and 2021 ended on a Friday. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwday(ymd(\"2020-12-31\"), label = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] Thu\nLevels: Sun < Mon < Tue < Wed < Thu < Fri < Sat\n```\n\n\n:::\n\n```{.r .cell-code}\nwday(ymd(\"2021-12-31\"), label = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] Fri\nLevels: Sun < Mon < Tue < Wed < Thu < Fri < Sat\n```\n\n\n:::\n:::\n\n\nThis means that the proportional counts in week 53 of 2020 and week 1 of 2021 are in the same week! We can combine them to better represent the full week's observations and save the combined count in week 1 of 2021.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds_mean_prop <- birds_mean_prop |>\n  rows_update(tibble(week = 1, year_2021 = sum(birds_mean_prop$year_2020[53] + birds_mean_prop$year_2021[1]))) |>\n  rows_update(tibble(week = 53, year_2020 = NA)) # remove 2020's week 53 count\n\nbirds_mean_prop |> slice_head(n = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n   week year_2020 year_2021 mean_2017_19\n  <dbl>     <dbl>     <dbl>        <dbl>\n1     1    0.0313    0.0290       0.0253\n2     2    0.0228    0.0191       0.0234\n3     3    0.0239    0.0201       0.0203\n```\n\n\n:::\n\n```{.r .cell-code}\nbirds_mean_prop |> slice_tail(n = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n   week year_2020 year_2021 mean_2017_19\n  <dbl>     <dbl>     <dbl>        <dbl>\n1    51    0.0181   0.0145       0.0162 \n2    52    0.0216   0.0159       0.0181 \n3    53   NA        0.00124      0.00291\n```\n\n\n:::\n:::\n\n\nTo allow us to plot proportional counts from Jan 2020 to Dec 2021 as one line (105 weeks total), we'll separate our 2021 proportional counts, revise 2021 week numbers to start from 53, and place them under our 2020 proportions. That'll let us plot from week 1 to week 105!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 2021 record count proportions\nbirds_2021 <- birds_mean_prop |>\n  select(-year_2020) |>\n  rename(prop = year_2021) |>\n  mutate(week = week + 52)\n\nglimpse(birds_2021)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 53\nColumns: 3\n$ week         <dbl> 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 6…\n$ prop         <dbl> 0.02902850, 0.01912429, 0.02012636, 0.01897143, 0.0183769…\n$ mean_2017_19 <dbl> 0.02528978, 0.02338032, 0.02031649, 0.01971618, 0.0186806…\n```\n\n\n:::\n\n```{.r .cell-code}\n# 2020 + 2021 record count proportions\nbirds_final <- birds_mean_prop |>\n  select(-year_2021) |>\n  drop_na() |>\n  rename(prop = year_2020) |>\n  bind_rows(birds_2021) # attach 2021 to the bottom\n\nglimpse(birds_final)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 105\nColumns: 3\n$ week         <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…\n$ prop         <dbl> 0.031281979, 0.022754179, 0.023857776, 0.024439673, 0.015…\n$ mean_2017_19 <dbl> 0.02528978, 0.02338032, 0.02031649, 0.01971618, 0.0186806…\n```\n\n\n:::\n:::\n\n\n\n\n# Lockdowns\n\nDuring the height of the pandemic, Melbourne had 6 distinct lockdowns. Let's add their start and end dates to a `tibble`.\n\nBecause we want to plot 2020 and 2021 on the same plot, we'll use `ifelse()` to make sure our week numbers in 2021 match our week numbers in `birds_final`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_lockdown <- c(1:6)\nstart_date <- c(\"2020-03-31\", \"2020-07-09\",\n                \"2021-02-13\", \"2021-05-28\",\n                \"2021-07-16\", \"2021-08-05\")\nend_date <- c(\"2020-05-12\", \"2020-10-27\",\n              \"2021-02-17\", \"2021-06-10\",\n              \"2021-07-27\", \"2021-10-21\")\n\nlockdowns <- tibble(n_lockdown, start_date, end_date) |>\n  mutate(\n    n_days = as_date(ymd(end_date)) - as_date(ymd(start_date)),\n    week_start = ifelse(year(start_date) == 2020, \n                        week(start_date), week(start_date) + 52),\n    week_end = ifelse(year(end_date) == 2020, \n                      week(end_date), week(end_date) + 52),\n    )\nlockdowns \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  n_lockdown start_date end_date   n_days   week_start week_end\n       <int> <chr>      <chr>      <drtn>        <dbl>    <dbl>\n1          1 2020-03-31 2020-05-12  42 days         13       19\n2          2 2020-07-09 2020-10-27 110 days         28       43\n3          3 2021-02-13 2021-02-17   4 days         59       59\n4          4 2021-05-28 2021-06-10  13 days         74       75\n5          5 2021-07-16 2021-07-27  11 days         81       82\n6          6 2021-08-05 2021-10-21  77 days         83       94\n```\n\n\n:::\n:::\n\n\n\n# Make plot\n\nTo help us see the components of our final plot more clearly, let's construct our visualisation step-by-step.\n\nFirst, we'll add our lockdown dates as highlighted rectangular blocks. To do this we can use `geom_rect()`, setting the `xmin` and `xmax` values to our `week_start` and `week_end` columns in `lockdowns`. We'll make the rectangle spread across the entire plot by setting `ymax = Inf` and `ymin = 0`.\n\nWe'll also set our `fill` inside of `aes()` and define its value within `scale_fill_manual()` which will allow us to add the lockdown colour and label to its own legend. \n\n\n::: {.cell .column-body-outset layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- ggplot() +\n  geom_rect(data = lockdowns,\n            aes(xmin = week_start,\n                xmax = week_end,\n                fill = \"Lockdown\"),\n            ymin = 0,\n            ymax = Inf,\n            alpha=0.2) +\n  scale_fill_manual(\n    values = c(\"Lockdown\" = pilot_color(\"yellow\")))\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){fig-align='center' width=672 style=margin-left:auto;margin-right:auto;}\n:::\n:::\n\n\nNext we'll add our proportional species observation counts as lines. We can define their colours and edit the legend and axis labels, too. \n\n\n::: {.cell .column-body-outset layout-align=\"center\"}\n\n```{.r .cell-code}\np2 <- p1 +\n  # add lines\n  geom_line(data = birds_final, \n            aes(x = week, y = prop, \n            color = \"2020-21 Records\"), \n            linewidth = 1) + \n  geom_line(data = birds_final, \n            aes(x = week, y = mean_2017_19, \n            color = \"2017-19 Average\"),\n            linetype = \"twodash\", \n            linewidth = 0.8) + \n  # add fill\n  geom_area(data = birds_final, \n            aes(x = week, y = prop),\n            fill=pilot_color(\"blue\"), \n            alpha=0.3) + \n  scale_color_manual(values = c(pilot_color(\"orange\"),\n                                pilot_color(\"blue\")), \n                     labels = c(\"2017-19 (average)\", \n                                \"2020-21\")) +\n  guides(fill = guide_legend(title = \"\"), \n         color = guide_legend(title = \"Year\")) +\n  labs(y = \"Proportion of year's total observations\",\n       x = \"Month\",\n       title = \"Anatidae observations in Melbourne prior to & during COVID-19\")\np2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=672 style=margin-left:auto;margin-right:auto;}\n:::\n:::\n\n\nThe plot above is enough to see everything we need to see from our data. You *could* stop here if you wished, but we've gone ahead and made a more refined visualisation with nice fonts, axis scales, axis labels and titles!\n\n\n::: {.cell .column-page layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# add fonts\nfont_add_google(\"Montserrat\", family = \"mont\")\nfont_add_google(\"Hind\", family = \"hind\")  \nshowtext_auto(enable = TRUE)\n\np2 + \n  # make axis scales understandable\n  scale_y_continuous(expand = c(0, 0),\n                     limits = c(0, 0.035),\n                     labels = scales::percent_format()) +\n  scale_x_continuous(expand = c(0, 0),\n                     limits = c(1, 105),\n                     breaks = c(1, 14, 27, 40, 52, 65, 78, 91),\n                     labels = c(\"Jan\", \"Apr\", \"Jul\", \"Oct\", \"Jan\", \"Apr\", \"Jul\", \"Oct\")) +\n  # add year x axis labels\n  coord_cartesian(clip = \"off\") +\n  annotate_pilot(label = \"2020\", x = 27, y = 0, \n                 alpha = 0.7, vjust = 3.8,size = 10) +\n  annotate_pilot(label = \"2021\", x = 78, y = 0, \n                 alpha = 0.7, vjust = 3.8, size = 10) +\n  labs(title = \"*Anatidae* observations in Melbourne prior to & during COVID-19\") +\n  theme_pilot(grid = \"\",\n              axes = \"bl\") +\n  theme(axis.title.x = element_text(size = 23, vjust = -1.3),\n        axis.title.y = element_text(size = 23),\n        axis.text.x = element_text(size = 20),\n        axis.text.y = element_text(size = 20),\n        axis.line = element_line(linewidth = 0.5),\n        legend.text = element_text(size = 23),\n        legend.title = element_text(size = 20),\n        plot.caption = element_text(size = 18),\n        text = element_text(family = \"hind\"),\n        plot.title = element_markdown(family = \"mont\", size = 31),\n        plot.subtitle = element_markdown(family = \"mont\", size = 28))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=960 style=margin-left:auto;margin-right:auto;}\n:::\n:::\n\n\nNow that we have our final plot, we can see a few interesting trends: \n\n  1. In the first lockdown (soon after COVID-19 arrived in Australia), species observations were *lower* than the 2017-2019 average.\n  2. In the 2 longest lockdowns, species observations were *higher* than the 2017-2019 average.\n  3. In the last half of all lockdowns except the first lockdown, observations increased.\n  \nAre these trends that you expected to see? \n\nIt's impossible to make any claims of *why* these trends emerged from our data visualisation alone, but we can speculate (for fun!) \n\nWere people making fewer observations in the first lockdown because they were preoccupied with all the other priorities of settling into new working-from-home routines? Did people make more observations at the tail end of lockdowns because they were seeking relief from being inside by spending more time by natural ponds and lakes? \n\nSome evidence from the US found [more people were using natural spaces during COVID-19](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0243344), and [time in these spaces lowered depression and anxiety](https://www.sciencedirect.com/science/article/pii/S1353829222000740). A New Zealand study [found similar results](https://www.mdpi.com/2071-1050/14/12/7308).\n\n# Final thoughts\n\nThis post has detailed how you can use ALA data to explore relationships between record counts and events. Although we can't make any causal claims from what we see in our plot, making a time-series is a nice way to do some exploratory analysis on a lot of data!\n\n\n<details><summary style = \"color: #E06E53;\">Expand for session info</summary>\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.2 (2023-10-31 ucrt)\n os       Windows 10 x64 (build 19045)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  English_Australia.utf8\n ctype    English_Australia.utf8\n tz       Australia/Sydney\n date     2024-02-12\n pandoc   3.1.1 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] CRAN (R 4.3.2)\n forcats     * 1.0.0   2023-01-29 [1] CRAN (R 4.3.2)\n galah       * 2.0.1   2024-02-06 [1] CRAN (R 4.3.2)\n ggplot2     * 3.4.4   2023-10-12 [1] CRAN (R 4.3.1)\n ggtext      * 0.1.2   2022-09-16 [1] CRAN (R 4.3.2)\n htmltools   * 0.5.7   2023-11-03 [1] CRAN (R 4.3.2)\n lubridate   * 1.9.3   2023-09-27 [1] CRAN (R 4.3.2)\n pilot       * 4.0.0   2022-07-13 [1] Github (olihawkins/pilot@f08cc16)\n purrr       * 1.0.2   2023-08-10 [1] CRAN (R 4.3.2)\n readr       * 2.1.4   2023-02-10 [1] CRAN (R 4.3.2)\n sessioninfo * 1.2.2   2021-12-06 [1] CRAN (R 4.3.2)\n showtext    * 0.9-6   2023-05-03 [1] CRAN (R 4.3.2)\n showtextdb  * 3.0     2020-06-04 [1] CRAN (R 4.3.2)\n stringr     * 1.5.1   2023-11-14 [1] CRAN (R 4.3.2)\n sysfonts    * 0.8.8   2022-03-13 [1] CRAN (R 4.3.2)\n tibble      * 3.2.1   2023-03-20 [1] CRAN (R 4.3.2)\n tidyr       * 1.3.0   2023-01-24 [1] CRAN (R 4.3.2)\n tidyverse   * 2.0.0   2023-02-22 [1] CRAN (R 4.3.2)\n\n [1] C:/Users/KEL329/R-packages\n [2] C:/Users/KEL329/AppData/Local/Programs/R/R-4.3.2/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n\n</details>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}